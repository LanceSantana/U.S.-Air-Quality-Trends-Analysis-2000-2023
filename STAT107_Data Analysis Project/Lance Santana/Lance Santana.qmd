---
title: "SantanaLance_STAT107_Project"
author: "Lance Santana"
date: "November 16th, 2024"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

```{r}
#install packages
install.packages("ggplot2")
install.packages("maps")
install.packages("tidyverse")
```

data \<- read.csv("pollution_2000_2023.csv")

```{r}
#read pollution.csv data set
getwd()
pollution_data <- read.csv("/Users/lancesantana/Downloads/School Files/Active Files/STAT_107 Files/STAT_107_Git_Files/Stats107_Project/pollution_2000_2023.csv")
```

```{r}
#finding relevant ozone data
OZmean_vector <- pollution_data$O3.Mean
highest_OZmean <- max(OZmean_vector, na.rm = TRUE)
lowest_OZmean <- min(OZmean_vector, na.rm = TRUE)
mean_OZmean <- mean(OZmean_vector, na.rm = TRUE)
sd_OZmean <- sd(OZmean_vector, na.rm = TRUE)

list_OZ_mean_data <- list(higest_mean = highest_OZmean, lowest_mean = lowest_OZmean, mean_mean = mean_OZmean, sd = sd_OZmean)
print("Ozone statisticsa for all cities in the United States")
list_OZ_mean_data
```

```{r}
#Sorts highest ozone cities into a variable
top_3_oz_cities <- pollution_data[order(pollution_data$O3.Mean, decreasing = TRUE),]
top_3_oz_cities <- top_3_oz_cities[1:3, c("State", "City", "O3.Mean")]
top_3_oz_cities

#Sorts lowest ozone cities into a variable
bottom_3_oz_cities <- pollution_data[order(pollution_data$O3.Mean, decreasing = FALSE),]
bottom_3_oz_cities <- bottom_3_oz_cities[1:3, c("State", "City", "O3.Mean")]
bottom_3_oz_cities
```

```{r}
library(ggplot2)
library(maps)
library(tidyverse)

#creating cities data set, needed for maping as dataset contains city cordinates
data("us.cities")
us_cities <- us.cities
us_cities$name <- sapply(strsplit(us_cities$name," "), function(x) x[1])

#Norristown is not in us.cities data. Longitude and latitude added manually
norristown_info <- data.frame(
  name = "Norristown",
  long = -75.3437,
  lat = 40.1215 
)
us_cities <- bind_rows(us_cities, norristown_info)

#set variable with highest ozone city cordinates
oz_cities_match_top <- us_cities %>%
  filter(name %in% top_3_oz_cities$City)

#set variable with lowest ozone city cordinates
oz_cities_match_bottom <- us_cities %>%
  filter(name %in% bottom_3_oz_cities$City)

#maps cities 
maps ::map("state")
points(oz_cities_match_top$long, oz_cities_match_top$lat, col = "red", pch = 7)
points(oz_cities_match_bottom$long, oz_cities_match_bottom$lat, col = "blue", pch = 7)
legend("bottomright", legend = c("Highest Ozone", "Lowest Ozone"), col = c("red", "blue"), pch = c(7, 7), title = "Legend")

  



```

```{r}
pollution_data

oz_state_means <-


boxplot(x = state_name, y = state_oz,)
```
